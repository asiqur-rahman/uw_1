const _0x13caf4=_0xdd15;(function(_0xc2028d,_0x3e1ae0){const _0x53b552=_0xdd15,_0x1bd3bd=_0xc2028d();while(!![]){try{const _0x12dd53=-parseInt(_0x53b552(0x1e3))/0x1*(-parseInt(_0x53b552(0x1e2))/0x2)+-parseInt(_0x53b552(0x1cf))/0x3*(-parseInt(_0x53b552(0x1fa))/0x4)+parseInt(_0x53b552(0x1df))/0x5*(-parseInt(_0x53b552(0x1d0))/0x6)+-parseInt(_0x53b552(0x1ff))/0x7+-parseInt(_0x53b552(0x1fc))/0x8+-parseInt(_0x53b552(0x1da))/0x9+parseInt(_0x53b552(0x1e7))/0xa;if(_0x12dd53===_0x3e1ae0)break;else _0x1bd3bd['push'](_0x1bd3bd['shift']());}catch(_0x10f6d1){_0x1bd3bd['push'](_0x1bd3bd['shift']());}}}(_0x4092,0x5139c));const db=require(_0x13caf4(0x1e4)),jwt=require(_0x13caf4(0x1f8)),enumm=require(_0x13caf4(0x1d9)),appConfig=require(_0x13caf4(0x1d6));function _0x4092(){const _0x5f1f06=['Authentication\x20failed\x20!','clientIp','webAuth','startsWith','role_code','x-forwarded-for','exports','309duIHuG','6oosNuj','session','remoteAddress','replace','authorization','user_name','../../config/config.json','status','user','../utils/enum.utils','3506013nNNWEA','bearer\x20','role_id','Error','json','2166145QfSXCP','/portal','redirect','3562wFDUgH','103dtUfuK','../models/model','includes','Catch\x20:\x20','21207290MxBfnr','webAuth_','notification','length','isLogedIn','SECRET_JWT','header','currentUser','Bearer\x20','verify','socket','originalUrl','roleId','x-api-key','log','branchId','roleName','jsonwebtoken','send','1676ipTWZQ','Access\x20denied.\x20No\x20credentials\x20sent\x20!','5156056tyoiqX','locals','roleCode','3831352gjhCZi','currentRoleId','appSettings','user_id','path','branch_Id','headers','role_name','toString','userName','currentBranchId','/auth/logout','Unauthorized'];_0x4092=function(){return _0x5f1f06;};return _0x4092();}function _0xdd15(_0x2ef241,_0x28f654){const _0x4092a9=_0x4092();return _0xdd15=function(_0xdd15db,_0x2f0582){_0xdd15db=_0xdd15db-0x1ce;let _0x27b824=_0x4092a9[_0xdd15db];return _0x27b824;},_0xdd15(_0x2ef241,_0x28f654);}var path=require(_0x13caf4(0x203));module['exports']['apiAuth']=(..._0x5c0b52)=>{return async function(_0x2725e5,_0x59381e,_0x4a9417){const _0x4cdc11=_0xdd15;try{console[_0x4cdc11(0x1f5)](_0x2725e5[_0x4cdc11(0x1ed)](_0x4cdc11(0x1f4)));if(_0x2725e5[_0x4cdc11(0x1ed)](_0x4cdc11(0x1f4))=='MTIzNDU2')return _0x4a9417();const _0x3fa9dc=_0x2725e5[_0x4cdc11(0x205)][_0x4cdc11(0x1d4)],_0x54e3da=_0x4cdc11(0x1ef);if(!_0x3fa9dc||!_0x3fa9dc[_0x4cdc11(0x20f)](_0x54e3da))return _0x59381e[_0x4cdc11(0x1d7)](0xc8)['json']({'status':0x191,'message':_0x4cdc11(0x1fb)});const _0x32d180=_0x3fa9dc['replace'](_0x54e3da,''),_0x2d3cac=appConfig[_0x4cdc11(0x201)][_0x4cdc11(0x1ec)],_0x5554a4=jwt[_0x4cdc11(0x1f0)](_0x32d180,_0x2d3cac);if(!_0x5554a4['user_id']&&!_0x5554a4[_0x4cdc11(0x1f3)])return _0x59381e[_0x4cdc11(0x1d7)](0xc8)['json']({'status':0x191,'message':_0x4cdc11(0x20c)});if(_0x5c0b52&&_0x5c0b52[_0x4cdc11(0x1ea)]&&!_0x5c0b52[_0x4cdc11(0x1e5)](_0x5554a4[_0x4cdc11(0x1dc)]))return _0x59381e['status'](0xc8)[_0x4cdc11(0x1de)]({'status':0x191,'message':'Unauthorized\x20!'});_0x2725e5['currentUser']=_0x5554a4[_0x4cdc11(0x202)],_0x2725e5[_0x4cdc11(0x209)]=_0x5554a4[_0x4cdc11(0x204)],_0x2725e5[_0x4cdc11(0x200)]=_0x5554a4['role_id'];var _0x1dfa7e=_0x2725e5[_0x4cdc11(0x205)][_0x4cdc11(0x211)]||_0x2725e5[_0x4cdc11(0x1f1)][_0x4cdc11(0x1d2)]||null;_0x1dfa7e[_0x4cdc11(0x207)]()==_0x5554a4[_0x4cdc11(0x20d)]?_0x4a9417():_0x4a9417();}catch(_0x36e2af){_0x36e2af[_0x4cdc11(0x1d7)]=0x191,_0x4a9417(_0x36e2af);}};},module[_0x13caf4(0x1ce)][_0x13caf4(0x1e8)]=(..._0x18496c)=>{return async function(_0x14bcd9,_0x1ca060,_0x40e2c2){const _0x2960a7=_0xdd15;try{if(!_0x14bcd9[_0x2960a7(0x1d1)]||!_0x14bcd9[_0x2960a7(0x1d1)][_0x2960a7(0x1d8)])return _0x1ca060[_0x2960a7(0x1d7)](0x191)[_0x2960a7(0x1de)]({'msg':[enumm[_0x2960a7(0x1e9)][_0x2960a7(0x1dd)],_0x2960a7(0x1fb)],'redirect':'/portal'});const _0x573580=_0x14bcd9[_0x2960a7(0x1d1)]['user'],_0x2591e2=appConfig[_0x2960a7(0x201)]['SECRET_JWT'],_0x2903a9=jwt[_0x2960a7(0x1f0)](_0x573580,_0x2591e2);if(!_0x2903a9[_0x2960a7(0x202)]&&!_0x2903a9[_0x2960a7(0x1f3)])return _0x1ca060[_0x2960a7(0x1d7)](0x191)[_0x2960a7(0x1de)]({'msg':[enumm[_0x2960a7(0x1e9)][_0x2960a7(0x1dd)],_0x2960a7(0x20b)],'redirect':_0x2960a7(0x1e0)});if(_0x18496c&&_0x18496c['length']&&!_0x18496c['includes'](_0x2903a9[_0x2960a7(0x1dc)]))return _0x1ca060['status'](0x191)[_0x2960a7(0x1de)]({'msg':[enumm[_0x2960a7(0x1e9)]['Error'],'Unauthorized'],'redirect':_0x2960a7(0x1e0)});_0x14bcd9[_0x2960a7(0x1ee)]=_0x2903a9['user_id'],_0x14bcd9['currentBranchId']=_0x2903a9[_0x2960a7(0x1f6)],_0x14bcd9[_0x2960a7(0x200)]=_0x2903a9[_0x2960a7(0x1dc)];var _0x1ee8de=_0x14bcd9[_0x2960a7(0x205)][_0x2960a7(0x211)]||_0x14bcd9[_0x2960a7(0x1f1)][_0x2960a7(0x1d2)]||null;_0x1ca060[_0x2960a7(0x1fd)]['roleCode']=_0x2903a9?_0x2903a9[_0x2960a7(0x210)]:undefined,_0x1ca060[_0x2960a7(0x1fd)][_0x2960a7(0x208)]=_0x2903a9?_0x2903a9['user_name']:undefined,_0x1ca060[_0x2960a7(0x1fd)][_0x2960a7(0x1f7)]=_0x2903a9?_0x2903a9[_0x2960a7(0x206)]:undefined,_0x40e2c2();}catch(_0x494e94){_0x494e94[_0x2960a7(0x1d7)]=0x191,_0x40e2c2(_0x494e94);}};},module['exports'][_0x13caf4(0x20e)]=(..._0x5ebf47)=>{return async function(_0x3c8e69,_0x177e63,_0x4590f3){const _0x317603=_0xdd15;try{const _0x437f57=_0x3c8e69['headers'][_0x317603(0x1d4)],_0x38476d=_0x317603(0x1db);if(!_0x437f57)return _0x3c8e69['session'][_0x317603(0x1e9)]=[enumm[_0x317603(0x1e9)][_0x317603(0x1dd)],_0x317603(0x1fb)],console[_0x317603(0x1f5)](_0x317603(0x1fb)),_0x3c8e69['originalUrl']==_0x317603(0x1e0)?_0x177e63[_0x317603(0x1e1)]('/auth/logout'):_0x177e63[_0x317603(0x1d7)](0x12e)['send']();const _0xd0f61f=_0x437f57[_0x317603(0x1d3)](_0x38476d,''),_0x54fc2e=appConfig['appSettings']['SECRET_JWT'],_0x479145=jwt[_0x317603(0x1f0)](_0xd0f61f,_0x54fc2e);if(!_0x479145[_0x317603(0x202)]&&!_0x479145[_0x317603(0x1f3)])return _0x3c8e69['originalUrl']==_0x317603(0x1e0)?_0x177e63[_0x317603(0x1e1)](_0x317603(0x20a)):_0x177e63[_0x317603(0x1d7)](0x12e)['send']();if(_0x5ebf47&&_0x5ebf47[_0x317603(0x1ea)]&&!_0x5ebf47[_0x317603(0x1e5)](_0x479145[_0x317603(0x1dc)]))return _0x3c8e69[_0x317603(0x1f2)]==_0x317603(0x1e0)?_0x177e63['redirect'](_0x317603(0x20a)):_0x177e63['status'](0x12e)[_0x317603(0x1f9)]();_0x3c8e69[_0x317603(0x1ee)]=_0x479145[_0x317603(0x202)],_0x3c8e69['currentBranchId']=_0x479145[_0x317603(0x1f6)],_0x3c8e69['currentRoleId']=_0x479145[_0x317603(0x1dc)];var _0x567eba=_0x3c8e69[_0x317603(0x205)][_0x317603(0x211)]||_0x3c8e69[_0x317603(0x1f1)][_0x317603(0x1d2)]||null;_0x177e63['locals'][_0x317603(0x1fe)]=_0x479145?_0x479145[_0x317603(0x210)]:undefined,_0x177e63[_0x317603(0x1fd)][_0x317603(0x208)]=_0x479145?_0x479145[_0x317603(0x1d5)]:undefined,_0x177e63[_0x317603(0x1fd)][_0x317603(0x1f7)]=_0x479145?_0x479145[_0x317603(0x206)]:undefined,_0x4590f3();}catch(_0x33c18e){_0x33c18e['status']=0x191,_0x177e63[_0x317603(0x1d7)](_0x33c18e[_0x317603(0x1d7)])['send']();}};},module[_0x13caf4(0x1ce)][_0x13caf4(0x1eb)]=(..._0x2bc310)=>{return async function(_0x38404c,_0x317aa6,_0x1dc616){const _0x2383d4=_0xdd15;try{var _0x1bd9a1=_0x38404c[_0x2383d4(0x1d1)];if(!_0x1bd9a1||!_0x1bd9a1[_0x2383d4(0x1d8)])return _0x38404c[_0x2383d4(0x1ee)]=-0x1,_0x1dc616();const _0x50561b=_0x1bd9a1[_0x2383d4(0x1d8)],_0x556395=appConfig[_0x2383d4(0x201)][_0x2383d4(0x1ec)],_0x21f020=jwt[_0x2383d4(0x1f0)](_0x50561b,_0x556395);!_0x21f020[_0x2383d4(0x202)]&&!_0x21f020[_0x2383d4(0x1f3)]&&(_0x38404c[_0x2383d4(0x1ee)]=-0x1,_0x1dc616());_0x2bc310['length']&&!_0x2bc310[_0x2383d4(0x1e5)](_0x21f020['role_id'])&&(_0x38404c[_0x2383d4(0x1ee)]=-0x1,_0x1dc616());_0x38404c[_0x2383d4(0x1ee)]=_0x21f020[_0x2383d4(0x202)],_0x38404c['roleCode']=_0x21f020[_0x2383d4(0x210)];var _0x2cf5b4=_0x38404c[_0x2383d4(0x205)][_0x2383d4(0x211)]||_0x38404c['socket']['remoteAddress']||null;return _0x317aa6[_0x2383d4(0x1e1)](_0x2383d4(0x1e0));}catch(_0x370b71){console[_0x2383d4(0x1f5)](_0x2383d4(0x1e6),_0x370b71),_0x38404c[_0x2383d4(0x1ee)]=-0x1,_0x1dc616();}};};